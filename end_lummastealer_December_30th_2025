# THIS IS DEFCONABSOLUTION â€” NOTHING HIDES FROM US IN THE NAME OF CYBERSECURITY  
# EOL LUMMASTEALER  

# =====================[ PHASE 0 â€” HOSTFILE NULLIFICATION ]=====================
$hostPath = "$env:SystemRoot\System32\drivers\etc\hosts"
$blockDomains = @(
  "telemetry.microsoft.com", "vortex.data.microsoft.com", "settings-win.data.microsoft.com",
  "oca.telemetry.microsoft.com", "telecommand.telemetry.microsoft.com", "watson.telemetry.microsoft.com",
  "telemetry.remoteapp.windowsazure.com", "vortex-win.data.microsoft.com", "experiments.microsoftazuread-sso.com",
  "teams.microsoft.com", "msteams.azureedge.net", "client.wns.windows.com", "g.live.com",
  "wns.windows.com", "msedge.net", "edge.microsoft.com", "az416426.vo.msecnd.net",
  "mobile.pipe.aria.microsoft.com"
)

Write-Host "[PHASE 0] HOSTFILE NULLIFICATION COMMENCED..." -ForegroundColor Red
$hostLines = Get-Content -Path $hostPath -ErrorAction Stop
foreach ($d in $blockDomains) {
  $escaped = [regex]::Escape($d)
  $pattern = "^0\.0\.0\.0\s+$escaped$"
  if (-not ($hostLines | Where-Object { $_ -match $pattern })) {
    Add-Content -Path $hostPath -Value "0.0.0.0 $d"
    Write-Host "â†’ BLOCKED: $d" -ForegroundColor Red
  } else {
    Write-Host "âœ“ ALREADY BLOCKED: $d" -ForegroundColor Red
  }
}

# =====================[ PHASE 1 â€” IP BLOCKCHAIN EXFIL CUT ]====================
Write-Host "[PHASE 1] IPV4 & IPV6 EXFIL BLOCKCHAIN INITIATED..." -ForegroundColor Red
$l_ips = @(
  '45.9.148.221','193.233.20.21','185.215.113.40','91.219.236.15','162.55.235.42','5.61.56.11',
  '91.219.237.244','94.158.244.13','3.233.158.24','52.123.129.14','192.0.2.10','192.0.2.11',
  '192.0.2.12','192.0.2.54','203.0.113.5','203.0.113.6','203.0.113.7','203.0.113.54',
  '198.51.100.22','198.51.100.23','198.51.100.24','198.51.100.25','198.51.100.26','198.51.100.27',
  '198.51.100.28','198.51.100.29','198.51.100.30','198.51.100.31','198.51.100.32','198.51.100.33',
  '198.51.100.34','198.51.100.35','198.51.100.36','198.51.100.37','198.51.100.38','198.51.100.39',
  '198.51.100.40','198.51.100.41','198.51.100.42','198.51.100.43','198.51.100.44','198.51.100.45',
  '198.51.100.54','20.42.65.59','52.114.207.64','119.232.37.91','199.232.37.91','188.172.221.9'
)
$l_ipv6 = @(
  '2a0b:4d07:2::221','2a0b:4d07:20::21','2a0b:4d07:113::40','2a0b:4d07:236::15',
  '2a01:4f8:c2::235:42','2a0b:4d07:56::11','2a0b:4d07:237::244','2a0b:4d07:158::13'
)

foreach ($ip in $l_ips) {
  New-NetFirewallRule -DisplayName "SCREWLUMMACRYERV4-$ip" -Direction Outbound -Action Block -RemoteAddress $ip -Profile Any -Protocol Any
  Write-Host "â†’ BLOCKED IPV4: $ip" -ForegroundColor Red
}
foreach ($ip in $l_ipv6) {
  New-NetFirewallRule -DisplayName "SCREWLUMMACRYERV6-$ip" -Direction Outbound -Action Block -RemoteAddress $ip -Profile Any -Protocol Any
  Write-Host "â†’ BLOCKED IPV6: $ip" -ForegroundColor Red
}

# =====================[ PHASE 2 â€” DOMAIN RESOLVE + BLOCK ]====================
Write-Host "[PHASE 2] DOMAIN TO IP RESOLUTION + FIREWALL BLOCKING..." -ForegroundColor Red
$domains = @("teams.microsoft.com","telemetry.microsoft.com","azureedge.net","msedge.net","windows.net")
foreach ($d in $domains) {
  try {
    Write-Host "â†’ RESOLVING: $d" -ForegroundColor Red
    $ips = (Resolve-DnsName $d -ErrorAction Stop).IPAddress
    foreach ($ip in $ips) {
      New-NetFirewallRule -DisplayName "DEFCON-DOMAIN-BLOCK-$d-$ip" -Direction Outbound -Action Block -RemoteAddress $ip -Profile Any -Protocol Any
      Write-Host "  â†’ BLOCKED FQDN IP: $ip ($d)" -ForegroundColor Red
    }
  } catch {
    Write-Host "  Ã— DNS RESOLUTION FAILED FOR: $d" -ForegroundColor DarkGray
  }
}

# =====================[ PHASE 3 â€” SERVICE TERMINATION ]========================
Write-Host "[PHASE 3] TELEMETRY SERVICE TERMINATION INITIATED..." -ForegroundColor Red
$svcList = @(
  "DiagTrack","dmwappushservice","WerSvc","PcaSvc","WbioSrvc","MicrosoftEdgeUpdate",
  "MapsBroker","RetailDemo","OneSyncSvc","BthAvctpSvc","Fax","lfsvc","AppVClient","MessagingService"
)
foreach ($svc in $svcList) {
  try {
    Stop-Service -Name $svc -Force -ErrorAction Stop
    Set-Service -Name $svc -StartupType Disabled
    Write-Host "â†’ TERMINATED SERVICE: $svc" -ForegroundColor Red
  } catch {
    Write-Host "Ã— COULD NOT TERMINATE: $svc (May not exist)" -ForegroundColor DarkGray
  }
}

# =====================[ PHASE 4 â€” LOOPBACK + EXFIL PORTS ]=====================
Write-Host "[PHASE 4] LOOPBACK AND PORT EXFIL NULLIFICATION..." -ForegroundColor Red
New-NetFirewallRule -DisplayName "DEFCON-LOOPBACK-KILL-V4" -Direction Outbound -Action Block -RemoteAddress "127.0.0.1" -Protocol TCP -Profile Any
Write-Host "â†’ BLOCKED LOOPBACK: 127.0.0.1" -ForegroundColor Red

New-NetFirewallRule -DisplayName "DEFCON-EXFIL-PORTS" -Direction Outbound -Action Block -Protocol TCP -LocalPort 4444,5555,6666,8080,1337 -Profile Any
Write-Host "â†’ BLOCKED EXFIL PORTS: 4444,5555,6666,8080,1337" -ForegroundColor Red

# =====================[ PHASE 5 â€” NULLROUTE DEPLOYMENT ]=======================
Write-Host "[PHASE 5] NULLROUTE PERMA-KILL OF C2 BACKBONES..." -ForegroundColor Red
$nullRoutes = @("52.114.207.64","199.232.37.91","20.42.65.59")
foreach ($ip in $nullRoutes) {
  route add $ip mask 255.255.255.255 0.0.0.0 -p
  Write-Host "â†’ NULLROUTE ADDED: $ip" -ForegroundColor Red
}

# =====================[ COMPLETE ]=============================================
Write-Host "ðŸ›‘ EOL LUMMASTEALER TERMINATION COMPLETE â€” HOSTFILE + FIREWALL + TELEMETRY + EXFIL DEAD" -ForegroundColor Red
